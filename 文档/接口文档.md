# 1. 书籍部分接口文档


## 书单                     GET
### 接口1
*  url示例：**47.102.46.161/AT_read/book_list1/?list_id=**
* 补充说明：list_id为书单号

*  js示例：

``` 
{
    'book_list':{
                 'name':书单名 ,
                 'image':书单封面 ,
                 'number':'书单内图书数',
                 'content': 书单介绍
                        }，
          
    'info': [
                {
     		     "title": "书名",             
    		     "image": "封面图片的绝对路径",
    		     "author": "作者，出版社等信息",  # 有\n 进行分割  
    		     "content": "简介，str",
     		     "num": "书籍序号，与豆瓣相同"
                 }
            ···
            ]
        }
        
```

返回值：

```
{'result': '400', 'detail': '参数有误'}
(成功则为json)
```



### 接口2（书单页）
* url示例：**47.102.46.161/AT_read/book_list2/?list_class=**
* 说明：list_class为固定的数字1/2/3/4/5，表示五种不同的书单类型<br>即：类型1-5

json:

```
｛'book':
   [
       {
           "name" : "书单名",
           "image" : img,
           "number" :"书单内图书数量",
           "num" : "书单号"
       },
       ···]
  }


```

返回值：

```
{'result': '400', 'detail': '参数有误'}
```


##  新书速递            GET

*  url示例：**47.102.46.161/AT_read/book_list**


*  js示例：
  
   
  
	```       
   
    [  
     'book':
       [
         {
           "title": "书名",
            "image": "封面图片的绝对路径",
            "author": "作者，出版社等信息",
            "content": "简介，str",
            "num": "书籍序号，与豆瓣相同"
            "score":评分 
                },
                
               ···]
    ]
  ```
  
   
  
   
  
   


## 图书详情    GET
* url示例：**47.102.46.161/AT_read/book/?num=**        

* 补充说明：num为书籍ID（返回的json附带评论等信息）

*  js示例：

	     { "book":
              {
                "title": "书名",
                "info": "作者，出版社等信息",
                "img": {'img_l':'', img_s: ''},                   
                "introduce": 图书简介完整， 
                "score": "评分" 
                "people": "评论人数",                              
                "done": "已读人数",                          
                "progress": "在读人数",                
                "want": "想读人数"                     
               }，
          "shortcomments":
	              [{
                   "image":"头像，url",
                   "name":"昵称/用户名",
                   "status":"状态",  # 0，1，2分别代表想读，在读，已读
                    "content":"书评内容"    
                    "score":"评分",    
                    "time"："评论时间" 
                    "book_num":'书籍id'         
                },
                ..... 
                 ]，
          "bookcomments":
                  [{
                    "image":"头像",
                    "name":"昵称/用户名",
                    "status":"状态",  # 0，1，2分别代表想读，在读，已读
                    "content":"书评内容", 
        
                     "word": '书评内容的文字'
                     "title": '评论的标题',
                        
                     "score":"评分",   
                     "time"："评论时间" 
                     "book_num":书籍id         
                }
                .....   ]
          "number":{  "shortcomments":"1/0,(有无评论)
                        "bookcomments":"1/0"}
    
      }
  
  返回值：
  
  ```
  {'result': '400', 'detail': '参数有误'}
  (成功则为json)
  ```
  
  
  
  
  

## 评论 需要登陆
* url示例：**47.102.46.161/AT_read/book_review/?num= &type='l/s'**                       POST

*  说明：获取用户的评论,num为书籍id,l/s分别为长评与短评

```
   
   {  "comments":
                
        {
                 'title': '评论标题'
                 "content":"书评内容"   
                 "score":"评分",   
                 "book_num":书籍id
                           
            }
         
        }

```

* {'result': result, 'detail': detail}
* 可能的返回值
      200   OK
        402   请求有误
        400   参数有误
        401   用户未登陆

## 图书状态

### 获取 需要登陆

* url示例：**47.102.46.161/AT_read/status/?num= **                   GET
  
   ```
    {"result":0/1/2/3}  # 分别代表想读，在读，已读、默认
    或
    {'result': '401', 'detail':'用户未登陆'}
    {'result': '400', 'detail': '参数有误'}
   ```
   
   

### 更改 需要登陆

* url示例：**47.102.46.161/AT_read/status/?num= **                       POST
       {"status":0/1/2}

* json : {'result': result, 'detail': detail}

* 可能的值

    ```
    200   OK
    402   请求有误
    401   用户未登陆
    ```
    

# 2. 用户相关接口

## 用户登录页

- url示例：**http://47.102.46.161/user/login**                                               

- 请求方式：POST

- 请求提交方式表单：

    ```表单
    {
    	"username":用户名,
    	"password":密码,
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未提交POST请求' 				 code：1001
    * result：'未提交全部参数'                    code：1002
    * result：'用户名不存在'                        code：1003
    * result：'用户名或者密码错误'            code：1004
    * result：'该用户已经被冻结'                code：1005
    * result：'登陆成功'                               code：1000

## 注册表单页

- url示例：**http://47.102.46.161/register**  

- 请求方式：POST

- 请求提交表单：

    ```表单
    {
    	"username":用户名,
    	"email":邮箱,
    	"password":密码,
        "name":昵称(可以不用提交),
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未提交POST请求'   code：1001

    * result：'未提交全部参数'     code：1002

    * result：'用户名已经存在'     code：1007

    * result：'用户名格式不正确' code：1008

    * result：'密码格式不正确'     code：1008

    * result：'邮箱格式不正确'     code：1008

    * result：'昵称格式不正确'     code：1008

    * result： '验证码发送成功'    code：1000

## 验证码验证页

- url示例：**http://47.102.46.161/user/check_code**

- 请求方式：POST

- 请求提交表单：

    ```表单
    {
    	"code":验证码,
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未提交POST请求'   code：1001

    * result：'未提交全部参数'     code：1002

    * result：'用户名不存在'         code：1004

    * result：'用户名已经激活'     code：1006

    * result：'验证码错误'             code：1009

    * result：'验证码验证成功'     code：1000

## 退出登录页*

- url示例：**http://47.102.46.161/user/logout**

- 请求方式：GET

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'退出登录成功'         code：1000

## 忘记密码页

- url示例：**http://47.102.46.161/user/forget_password**

- 请求方式：POST

- 请求提交表单：

    ```表单
    {
    	"username":用户名,
    	"email":邮箱,
        "new_password":新密码,
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未提交POST请求'             code：1001
    * result：'未提交全部参数'               code：1002
    * result：'用户名不存在'                  code：1003
    * result：'用户名与邮箱不匹配'       code：1010
    * result：'新密码格式不正确'           code：1008
    * result：'该用户已经被冻结'           code：1005
    * result：'验证码发送成功'               code：1000

## 修改密码页*

- url示例：**http://47.102.46.161/user/change_password**

- 请求方式：POST

- 请求提交表单：

    ```表单
    {
        "old_password":原密码,
        "new_password":新密码,
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未提交POST请求'           code：1001
    * result：'未提交全部参数'            code：1002
    * result：'原密码不正确'                code：1004
    * result：'新密码格式不正确'        code：1008
    * result：'密码修改成功'                code：1000

## 昵称修改页*

- url示例：**http://47.102.46.161/user/change_name**

- 请求方式：POST

- 请求提交表单：

    ```表单
    {
    	"name":新昵称,
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未提交POST请求'     code：1001
    * result：'未提交全部参数'       code：1002
    * result：'昵称格式不正确'       code：1008
    * result：'昵称修改成功'           code：1000

## 头像修改页*

- url示例：**http://47.102.46.161/user/change_image**

- 请求方式：POST

- 图片格式：('image/jpeg', 'image/jpg', 'image/png')

- 请求提交表单：

    ```表单
    {
    	"image":新头像,
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未上传图片'                      code：1002
    * result：'图片格式不正确'              code：1008
    * result：'图片大于25M'                  code：1012
    * result：'头像修改成功'                  code：1000

## 个人中心页*

- url示例：**http://47.102.46.161/user/index**

- 请求方式：GET

- 请求返回数据:

    ```json
    {
        "user": {
            "username": 用户名,
            "nickname": 昵称,
            "icon": 头像,
            "email": 邮箱,
        },
        "want_read": [
            {
                "num": 书籍编号,
                "bookname": 书籍名称,
                "bookphoto": 书籍封面,
                "info": 书籍信息,
                "score": 书籍评分,
            },
        ],
        "reading": [
            {
                "num": 书籍编号,
                "bookname": 书籍名称,
                "bookphoto": 书籍封面,
                "info": 书籍信息,
                "score": 书籍评分,
            },
        ],
        "have_read": [
            {
                "num": 书籍编号,
                "bookname": 书籍名称,
                "bookphoto": 书籍封面,
                "info": 书籍信息,
                "score": 书籍评分,
            },
        ],
        "result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'用户已登录'          code：1000

## 我的评论获取页*

- url示例：**http://47.102.46.161/user/comment_request**

- 请求方式：GET

- 请求返回数据:

    ```json
    {
        "short": [
            {
                "id": 评论id,
                "content": 短评内容,
                "score": 评论打分,
                "create_time": 发表时间,
                "num": 书籍编号,
                "title": 书籍名称,
                "image": 书籍封面,
            }
        ],
        "long": [
            {
                "id": 评论id,
                "long_title": 长评标题,
                "content": 长评文本,
                "score": 评论打分,
                "create_time": 发表时间,
                "num": 书籍编号,
                "title": 书籍名称,
                "image": 书籍封面,
            }
        ],
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'用户已登录'         code：1000

## 评论删除页*

- url示例：**http://47.102.46.161/user/delete_comment**

- 请求方式：GET

    ```表单
    {
    	"comment_id": 评论id,
    	"type": 评论类型(short/long),
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未提交GET请求'                code ：1001

    * result：'未提交全部参数'               code ：1002

    * result：'type参数不正确'               code ：1008

    * result：'该用户未发表此评论'       code ：1011

    * result：'评论删除成功'                   code：1000

        


# 

# 3. 相关备注及接口

## 未登录返回页

- url示例：**http://47.102.46.161/user/***

- 请求方式：当访问带有星号的页面时，如果未登录则会返回此页面

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'用户未登录'           code：0000

## 图片上传页

- url示例：**http://47.102.46.161/user/image_upload**

- 请求方式：POST

- 图片格式：('image/jpeg', 'image/jpg', 'image/png')

- 请求提交表单：

    ```表单
    {
    	"image":图片,
    }
    ```

- 请求返回数据:

    ```json
    {
    	"result": 返回信息,
        "code": 返回信息码,
    }
    ```

    * result：'未上传图片'                      code：1002

    * result：'图片格式不正确'               code：1008

    * result：'图片大于25M'                  code：1012

    * result：‘http://47.102.46.161/media/xxx/xxx’ 
    
        code：1000

## 注意事项

1、图片返回的均为绝对路径

2、接口2,3所有返回值都有result和code

3、code值一览表

| code | 相关信息         |
| ---- | ---------------- |
| 1001 | 未提交相应的请求 |
| 1002 | 未提交全部参数   |
| 1003 | 信息不存在       |
| 1004 | 用户名或密码错误 |
| 1005 | 用户已经被冻结   |
| 1007 | 信息已经存在     |
| 1008 | 格式不正确       |
| 1009 | 验证码错误       |
| 1010 | 用户名邮箱不匹配 |
| 1011 | 信息不属于该用户 |
| 1000 | 操作成功         |
| 0000 | 用户未登录       |
| 1012 | 图片大于25M      |









***
## 特别的：
### &emsp;&emsp;所有数据无特殊说明皆为字符串
***

